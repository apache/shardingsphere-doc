<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.83.1" />
    <meta name="description" content="">
    <meta name="buildDate" content="2024-05-14 07:42:46">


    <link rel="shortcut icon" href="https://shardingsphere.apache.org/document/current/img/favicon.png" type="image/x-icon" />

    <title>ShardingSphere Operator User Manual :: ShardingSphereOnCloud</title>
    
    
    <link href="https://shardingsphere.apache.org/oncloud/current/css/nucleus.css?1715643766" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/current/css/font-awesome.min.css?1715643766" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/current/css/hybrid.css?1715643766" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/current/css/featherlight.min.css?1715643766" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/current/css/perfect-scrollbar.min.css?1715643766" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/current/css/auto-complete.css?1715643766" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/current/css/theme.css?1715643766" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/current/css/hugo-theme.css?1715643766" rel="stylesheet">
    
      <link href="https://shardingsphere.apache.org/oncloud/current/css/theme-white.css?1715643766" rel="stylesheet">
    

    <script src="https://shardingsphere.apache.org/oncloud/current/js/jquery-2.x.min.js?1715643766"></script>
    
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?d5a1dc8dcf63a64ee55b80de01c7fb1a";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();   
    </script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HETCF66YL0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-HETCF66YL0');
    </script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{ 
          display:none !important;
      }
      
      
      
    </style>
    

  </head>
  <body class="" data-url="https://shardingsphere.apache.org/oncloud/current/en/user-manual/cn-sn-operator/">
    <div class="change-theme">
    <div class="wrap">
        
        <span data-item="retro">
            <svg t="1649761460834" class="icon" viewBox="0 0 1243 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2052" width="16" height="16"><path d="M755.093336 61.436797a511.973304 511.973304 0 1 0 207.495466 693.650688l-99.615377-53.757197a398.827204 398.827204 0 1 1-161.637286-540.351253l53.757197-99.615378z" fill="#ffffff" p-id="2053"></path><path d="M1204.971593 188.84501L534.652259 736.217612l-285.242269-364.086159 86.304071-67.653615 216.199012 275.953611 583.649567-476.574007 69.335813 84.987568z" fill="#ffffff" p-id="2054"></path></svg>
            Retro
        </span>
        <span data-item="eyehelp">
            <svg t="1649761460834" class="icon" viewBox="0 0 1243 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2052" width="16" height="16"><path d="M755.093336 61.436797a511.973304 511.973304 0 1 0 207.495466 693.650688l-99.615377-53.757197a398.827204 398.827204 0 1 1-161.637286-540.351253l53.757197-99.615378z" fill="#ffffff" p-id="2053"></path><path d="M1204.971593 188.84501L534.652259 736.217612l-285.242269-364.086159 86.304071-67.653615 216.199012 275.953611 583.649567-476.574007 69.335813 84.987568z" fill="#ffffff" p-id="2054"></path></svg>
            Eye care
        </span>
        <span data-item="haitian">
            <svg t="1649761460834" class="icon" viewBox="0 0 1243 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2052" width="16" height="16"><path d="M755.093336 61.436797a511.973304 511.973304 0 1 0 207.495466 693.650688l-99.615377-53.757197a398.827204 398.827204 0 1 1-161.637286-540.351253l53.757197-99.615378z" fill="#ffffff" p-id="2053"></path><path d="M1204.971593 188.84501L534.652259 736.217612l-285.242269-364.086159 86.304071-67.653615 216.199012 275.953611 583.649567-476.574007 69.335813 84.987568z" fill="#ffffff" p-id="2054"></path></svg>
            Haitian
        </span>
        <span data-item="deep">
            <svg t="1649761460834" class="icon" viewBox="0 0 1243 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2052" width="16" height="16"><path d="M755.093336 61.436797a511.973304 511.973304 0 1 0 207.495466 693.650688l-99.615377-53.757197a398.827204 398.827204 0 1 1-161.637286-540.351253l53.757197-99.615378z" fill="#ffffff" p-id="2053"></path><path d="M1204.971593 188.84501L534.652259 736.217612l-285.242269-364.086159 86.304071-67.653615 216.199012 275.953611 583.649567-476.574007 69.335813 84.987568z" fill="#ffffff" p-id="2054"></path></svg>
            Deep
        </span>
        <span data-item="dark">
            <svg t="1649761460834" class="icon" viewBox="0 0 1243 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2052" width="16" height="16"><path d="M755.093336 61.436797a511.973304 511.973304 0 1 0 207.495466 693.650688l-99.615377-53.757197a398.827204 398.827204 0 1 1-161.637286-540.351253l53.757197-99.615378z" fill="#ffffff" p-id="2053"></path><path d="M1204.971593 188.84501L534.652259 736.217612l-285.242269-364.086159 86.304071-67.653615 216.199012 275.953611 583.649567-476.574007 69.335813 84.987568z" fill="#ffffff" p-id="2054"></path></svg>
            Dark
        </span>
        <span class="active">
            <svg t="1649761460834" class="icon" viewBox="0 0 1243 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2052" width="16" height="16"><path d="M755.093336 61.436797a511.973304 511.973304 0 1 0 207.495466 693.650688l-99.615377-53.757197a398.827204 398.827204 0 1 1-161.637286-540.351253l53.757197-99.615378z" fill="#ffffff" p-id="2053"></path><path d="M1204.971593 188.84501L534.652259 736.217612l-285.242269-364.086159 86.304071-67.653615 216.199012 275.953611 583.649567-476.574007 69.335813 84.987568z" fill="#ffffff" p-id="2054"></path></svg>
            Default
        </span>
        
    </div>
</div>



    <header>
      <div class="wrap">
        <a href="https://shardingsphere.apache.org/oncloud/"><img src="https://shardingsphere.apache.org/oncloud/images/LOGO.png" /></a>

        
        

        
        
        <section id="prefooter">
          
          <ul>
          
            <li>
              <a class="padding">
                <i class="fa fa-fw fa-language"></i>
              <div class="select-style">
                <select id="select-language" onchange="location = this.value;">
              
              
              
                  
                  
                      
                        
                        
                          <option id="en" value="https://shardingsphere.apache.org/oncloud/current/en/user-manual/cn-sn-operator/" selected>English</option>
                        
                      
                  
                      
                  
              
                  
                  
                      
                  
                      
                        
                        
                          <option id="cn" value="https://shardingsphere.apache.org/oncloud/current/cn/user-manual/cn-sn-operator/">简体中文</option>
                        
                      
                  
              
            </select>
            <svg t="1645437162166" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2449" width="32" height="32"><path d="M483.072 714.496l30.165333 30.208 415.957334-415.829333a42.837333 42.837333 0 0 0 0-60.288 42.538667 42.538667 0 0 0-60.330667-0.042667l-355.541333 355.413333-355.242667-355.413333a42.496 42.496 0 0 0-60.288 0 42.837333 42.837333 0 0 0-0.085333 60.330667l383.701333 383.872 1.706667 1.749333z" fill="#3D3D3D" p-id="2450"></path></svg>
            </div>
            </a>
            </li>
           
          
          
          </ul>
        </section>
        
      </div>
    </header>
    <div class="wrap">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    
    
        <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>

<script type="text/javascript" src="https://shardingsphere.apache.org/oncloud/current/js/lunr.min.js?1715643766"></script>
<script type="text/javascript" src="https://shardingsphere.apache.org/oncloud/current/js/auto-complete.js?1715643766"></script>
<script type="text/javascript">
    
        var baseurl = "\/en";
    
</script>
<script type="text/javascript" src="https://shardingsphere.apache.org/oncloud/current/js/search.js?1715643766"></script>

    
  </div>

    <div class="highlightable">
    <div class="leftMenu">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/en/overview/" title="Overview" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/overview/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>1. </b>Overview
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/en/quick-start/" title="Quick Start" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/quick-start/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
             <svg  class="icon icon-down" 
              style="display: none;"
              viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"   width="20" height="20" fill="#777">
              <path d="M500.8 604.778667L267.306667 371.392l-45.226667 45.269333 278.741333 278.613334 278.485334-278.613334-45.248-45.248z" p-id="5376" ></path>
            </svg>
            <svg  class="icon icon-right" 
              style="display: inline-block;"
              viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"  width="20" height="20" fill="#777">
              <path d="M593.450667 512.128L360.064 278.613333l45.290667-45.226666 278.613333 278.762666L405.333333 790.613333l-45.226666-45.269333z" p-id="5605" ></path>
            </svg>
          
          </i>
          <b>2. </b>Quick Start
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/en/quick-start/aws-quick-deployment/" title="ShardingSphere CloudFormation Quick Start" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/quick-start/aws-quick-deployment/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>2.1 </b>ShardingSphere CloudFormation Quick Start
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/quick-start/kubernetes-quick-deployment/" title="ShardingSphere Helm Charts Quick Start" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/quick-start/kubernetes-quick-deployment/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>2.2 </b>ShardingSphere Helm Charts Quick Start
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/en/features/" title="Features" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/features/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
             <svg  class="icon icon-down" 
              style="display: none;"
              viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"   width="20" height="20" fill="#777">
              <path d="M500.8 604.778667L267.306667 371.392l-45.226667 45.269333 278.741333 278.613334 278.485334-278.613334-45.248-45.248z" p-id="5376" ></path>
            </svg>
            <svg  class="icon icon-right" 
              style="display: inline-block;"
              viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"  width="20" height="20" fill="#777">
              <path d="M593.450667 512.128L360.064 278.613333l45.290667-45.226666 278.613333 278.762666L405.333333 790.613333l-45.226666-45.269333z" p-id="5605" ></path>
            </svg>
          
          </i>
          <b>3. </b>Features
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/en/features/quickdeployment/" title="Deployment on Cloud" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/features/quickdeployment/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>3.1 </b>Deployment on Cloud
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/features/dbre/" title="Database Reliability Engineering" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/features/dbre/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>3.2 </b>Database Reliability Engineering
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/features/shardingspherechaos/" title="ShardingSphere Chaos" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/features/shardingspherechaos/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>3.3 </b>ShardingSphere Chaos
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/features/ecosystemextensions/" title="Ecosystem" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/features/ecosystemextensions/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>3.4 </b>Ecosystem
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/en/user-manual/" title="User Manual" class="dd-item 
        parent
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/user-manual/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
             <svg  class="icon icon-down" 
              style="display: inline-block;"
              viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"   width="20" height="20" fill="#777">
              <path d="M500.8 604.778667L267.306667 371.392l-45.226667 45.269333 278.741333 278.613334 278.485334-278.613334-45.248-45.248z" p-id="5376" ></path>
            </svg>
            <svg  class="icon icon-right" 
              style="display: none;"
              viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"  width="20" height="20" fill="#777">
              <path d="M593.450667 512.128L360.064 278.613333l45.290667-45.226666 278.613333 278.762666L405.333333 790.613333l-45.226666-45.269333z" p-id="5605" ></path>
            </svg>
          
          </i>
          <b>4. </b>User Manual
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/en/user-manual/helm/" title="ShardingSphere Helm Charts User Manual" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/user-manual/helm/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>4.1 </b>ShardingSphere Helm Charts User Manual
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/user-manual/cn-sn-operator/" title="ShardingSphere Operator User Manual" class="dd-item 
        parent
        active
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/user-manual/cn-sn-operator/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>4.2 </b>ShardingSphere Operator User Manual
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/user-manual/cloudformation-multi-az/" title="CloudFormation Deploys ShardingSphere Proxy Cluster in Multiple AZs" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/user-manual/cloudformation-multi-az/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>4.3 </b>CloudFormation Deploys ShardingSphere Proxy Cluster in Multiple AZs
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/user-manual/using-terraform-to-deploy-multi-az-on-aws/" title="Terraform Deploys ShardingSphere Cluster in Multiple AZs On AWS" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/user-manual/using-terraform-to-deploy-multi-az-on-aws/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>4.4 </b>Terraform Deploys ShardingSphere Cluster in Multiple AZs On AWS
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/user-manual/using-terraform-to-deploy-multi-az-on-huaweicloud/" title="Terraform Deploys ShardingSphere Cluster in Multiple AZs On Huawei Cloud" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/user-manual/using-terraform-to-deploy-multi-az-on-huaweicloud/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>4.5 </b>Terraform Deploys ShardingSphere Cluster in Multiple AZs On Huawei Cloud
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/user-manual/chaos/" title="Chaos Engineering in ShardingSphere" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/current/en/user-manual/chaos/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>4.6 </b>Chaos Engineering in ShardingSphere
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
    
    </div>
    

    

    <section id="footer">
      <p></p>
    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/apache/shardingsphere-on-cloud/tree/master/docs/content/user-manual/cn-sn-operator/_index.en.md" target="blank">
                      <i class="fa fa-code-fork"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='https://shardingsphere.apache.org/oncloud/current/en/'>ShardingSphereOnCloud</a> > <a href='https://shardingsphere.apache.org/oncloud/current/en/user-manual/'>User Manual</a> > ShardingSphere Operator User Manual
          
         
          
         
          
           
                  </span>
                </div>
                
              </div>
            </div>
            

        
          <div id="chapter">
        
        <div id="body-inner">
          

        


<nav id="TableOfContents">
  <ul>
    <li><a href="#overview">Overview</a></li>
    <li><a href="#operator-installation">Operator Installation</a>
      <ul>
        <li><a href="#online-installation">Online Installation</a></li>
        <li><a href="#source-code-installation">Source Code Installation</a></li>
        <li><a href="#charts-parameters-instruction">Charts Parameters Instruction</a></li>
      </ul>
    </li>
    <li><a href="#crd-introduction">CRD Introduction</a>
      <ul>
        <li><a href="#shardingsphereproxy">ShardingSphereProxy</a></li>
        <li><a href="#computenode">ComputeNode</a></li>
        <li><a href="#storagenode">StorageNode</a></li>
        <li><a href="#storageprovider">StorageProvider</a></li>
      </ul>
    </li>
    <li><a href="#clean">Clean</a></li>
    <li><a href="#next">Next</a></li>
  </ul>
</nav>

<h2 id="overview">Overview</h2>
<p>ShardingSphere Operator is a practical implementation of the Kubernetes Operator model. It transforms the maintenance experience of ShardingSphere Proxy into an executable program and leverages Kubernetes&rsquo;s declarative and &ldquo;reconcile&rdquo; features for implementation.</p>
<p>ShardingSphere Operator abstracts computing nodes, storage nodes, and even chaos faults as Kubernetes Custom Resource Definitions (CRDs). Users are responsible for writing corresponding CRD configurations, while the Operator executives and ensures the desired state.</p>
<p>Please refer to the &lsquo;Operator Installation&rsquo; section to get installed and try it out, and refer to the &lsquo;CRD Introduction&rsquo; to get a better understanding of CRD&rsquo;s configuration.</p>
<h2 id="operator-installation">Operator Installation</h2>
<p>Operator currently supports Helm Charts rapid deployment, configuration content and configuration file directory is: apache-shardingsphere-operator-charts. Users can adopt online installation or source code installation depending on their needs.</p>
<h3 id="online-installation">Online Installation</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"> kubectl create ns shardingsphere-operator
 helm repo add shardingsphere https://apache.github.io/shardingsphere-on-cloud
 helm repo update
 helm install shardingsphere-cluster shardingsphere/apache-shardingsphere-operator-charts -n shardingsphere-operator --set zookeeper.persistence.enabled<span style="color:#f92672">=</span>false
</code></pre></div><h3 id="source-code-installation">Source Code Installation</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">kubectl create ns shardingsphere-operator
cd charts/apache-shardingsphere-operator-charts/
helm dependency build
cd ../
helm install shardingsphere-cluster apache-shardingsphere-operator-charts -n shardingsphere-operator --set zookeeper.persistence.enabled<span style="color:#f92672">=</span>false
</code></pre></div><h3 id="charts-parameters-instruction">Charts Parameters Instruction</h3>
<h4 id="common-parameters">Common Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nameOverride</code></td>
<td>nameOverride String to partially override common.names.fullname template will maintain the release name</td>
<td><code>shardingsphere-proxy</code></td>
</tr>
</tbody>
</table>
<h4 id="shardingsphere-operator-parameters">ShardingSphere Operator Parameters</h4>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>operator.replicaCount</code></td>
<td>Operstor replica count</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>operator.image.repository</code></td>
<td>Operator image name</td>
<td><code>apache/shardingsphere-operator</code></td>
</tr>
<tr>
<td><code>operator.image.pullPolicy</code></td>
<td>Image pull policy</td>
<td><code>IfNotPresent</code></td>
</tr>
<tr>
<td><code>operator.image.tag</code></td>
<td>Image tag</td>
<td><code>0.3.0</code></td>
</tr>
<tr>
<td><code>operator.imagePullSecrets</code></td>
<td>Image pull secret of private repository</td>
<td><code>[]</code></td>
</tr>
<tr>
<td><code>operator.resources</code></td>
<td>Operator resources required by the operator</td>
<td><code>{}</code></td>
</tr>
<tr>
<td><code>operator.health.healthProbePort</code></td>
<td>Operator health check pork</td>
<td><code>8080</code></td>
</tr>
</tbody>
</table>
<p>Users can choose whether to install the supporting management center depending on their needs when using Operator Charts for installation. The relevant parameters are as follows:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>zookeeper.enabled</code></td>
<td>Switch to eable or disable the ZooKeeper helm chart</td>
<td><code>true</code></td>
</tr>
<tr>
<td><code>zookeeper.replicaCount</code></td>
<td>Zookeeper replica count</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>zookeeper.persistence.enabled</code></td>
<td>Enable persistence on Zookeeper using PVC(s)</td>
<td><code>false</code></td>
</tr>
<tr>
<td><code>zookeeper.persistence.storageClass</code></td>
<td>Persistent Volume Storage Class</td>
<td><code>&quot;&quot;</code></td>
</tr>
<tr>
<td><code>zookeeper.persistence.accessModes</code></td>
<td>Persistent Volume access modes</td>
<td><code>[&quot;ReadWriteOnce&quot;]</code></td>
</tr>
<tr>
<td><code>zookeeper.persistence.size</code></td>
<td>Persistent Volume size</td>
<td><code>8Gi</code></td>
</tr>
</tbody>
</table>
<p>Note: currently the persist repository installed by Charts, supports Bitnami Zookeeper Charts only.</p>
<h2 id="crd-introduction">CRD Introduction</h2>
<h3 id="shardingsphereproxy">ShardingSphereProxy</h3>
<p>ShardingSphereProxy and ShardingSphereProxyServerConfig provide a basic description of deployment and configuration of ShardingSphereProxy, Operator submits and adds configuration provided by CRD convert to Kubernetes workload. ShardingSphereProxy effect relevant configuration of basic resource, and ShardingSphereProxyServerConfig effect <code>server.yaml</code>.</p>
<p>Note: ShardingSphereProxy and ShardingSphereProxyServerConfig planning end of support since 0.4.0 version.</p>
<h4 id="column-comment">Column Comment</h4>
<h5 id="programmatic-configuration">Programmatic Configuration</h5>
<p>ShardingSphereProxy</p>
<table>
<thead>
<tr>
<th>Configuration item</th>
<th>Description</th>
<th>Type</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>.spec.version</code></td>
<td>ShardingSphere-Proxy version</td>
<td>string</td>
<td><code>5.5.0</code></td>
</tr>
<tr>
<td><code>.spec.serviceType.type</code></td>
<td>Service type</td>
<td>string</td>
<td><code>NodePort</code></td>
</tr>
<tr>
<td><code>.spec.serviceType.nodePort</code></td>
<td>Node Port service</td>
<td>number</td>
<td><code>33307</code></td>
</tr>
<tr>
<td><code>.spec.replicas</code></td>
<td>Operstor replica count</td>
<td>number</td>
<td><code>3</code></td>
</tr>
<tr>
<td><code>.spec.proxyConfigName</code></td>
<td>Mounted configuration</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><code>.spec.port</code></td>
<td>Exposed port</td>
<td>number</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="optional-configuration">Optional Configuration</h5>
<table>
<thead>
<tr>
<th>Configuration item</th>
<th>Description</th>
<th>Type</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>.spec.automaticScaling.enable</code></td>
<td>Automatic scaling enable</td>
<td>bool</td>
<td><code>false</code></td>
</tr>
<tr>
<td><code>.spec.automaticScaling.scaleUpWindows</code></td>
<td>Maximum automatic scale limit</td>
<td>number</td>
<td></td>
</tr>
<tr>
<td><code>.spec.automaticScaling.scaleDownWindows</code></td>
<td>Minimum automatic scale limit</td>
<td>number</td>
<td></td>
</tr>
<tr>
<td><code>.spec.automaticScaling.target</code></td>
<td>Automatic scaling target</td>
<td>number</td>
<td></td>
</tr>
<tr>
<td><code>.spec.automaticScaling.maxInstance</code></td>
<td>Automatic scaling maxmum instance</td>
<td>number</td>
<td></td>
</tr>
<tr>
<td><code>.spec.automaticScaling.minInstance</code></td>
<td>Automatic scaling minimum instance</td>
<td>number</td>
<td></td>
</tr>
<tr>
<td><code>.spec.customMetrics</code></td>
<td>Custom metrics</td>
<td>[]autoscalingv2beta2.MetricSpec</td>
<td></td>
</tr>
<tr>
<td><code>.spec.imagePullSecrets</code></td>
<td>Image pull secrets</td>
<td>v1.Local,ObjectReference</td>
<td></td>
</tr>
<tr>
<td><code>.spec.mySQLDriver.version</code></td>
<td>MySQL driver version</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><code>.spec.resources</code></td>
<td>Resources configuration</td>
<td>v1.ResourceRequirements</td>
<td></td>
</tr>
<tr>
<td><code>.spec.livenssProbe</code></td>
<td>Liveness probe</td>
<td>v1.Probe</td>
<td></td>
</tr>
<tr>
<td><code>.spec.readinessProbe</code></td>
<td>Readness probe</td>
<td>v1.Probe</td>
<td></td>
</tr>
<tr>
<td><code>.spec.startupProbe</code></td>
<td>Startup probe</td>
<td>v1.Probe</td>
<td></td>
</tr>
</tbody>
</table>
<p>ShardingSphereProxyServerConfig</p>
<table>
<thead>
<tr>
<th>Configuration item</th>
<th>Description</th>
<th>Type</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>.spec.mode.type</code></td>
<td>string</td>
<td>Type of mode configuration, supports Standalone and Cluster</td>
<td>string</td>
</tr>
<tr>
<td><code>.spec.mode.repository.type</code></td>
<td>string</td>
<td>Type of persist repository, supports ZooKeeper and Etcd</td>
<td>string</td>
</tr>
<tr>
<td><code>.spec.mode.repository.props.namespace</code></td>
<td>string</td>
<td>Namespace of registry center(Not namespace of K8s)</td>
<td><code>governance_ds</code></td>
</tr>
<tr>
<td><code>.spec.mode.repository.props.server-lists</code></td>
<td>string</td>
<td>Server lists of registry center</td>
<td><code>zookeeper.default:2181</code></td>
</tr>
<tr>
<td><code>.spec.mode.repository.props.retryIntervalMilliseconds</code></td>
<td>number</td>
<td>Milliseconds of retry interval</td>
<td><code>500</code></td>
</tr>
<tr>
<td><code>.spec.mode.repository.props.maxRetries</code></td>
<td>number</td>
<td>Max retries of client connection</td>
<td><code>3</code></td>
</tr>
<tr>
<td><code>.spec.mode.repository.props.timeToLiveSeconds</code></td>
<td>number</td>
<td>TTL</td>
<td><code>600</code></td>
</tr>
<tr>
<td><code>.spec.mode.repository.props.operationTimetoutMilliseconds</code></td>
<td>number</td>
<td>Milliseconds of operation timeout</td>
<td><code>5000</code></td>
</tr>
<tr>
<td><code>.spec.mode.repository.props.digest</code></td>
<td>Abstract</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><code>.spec.authority.users[0].user</code></td>
<td>Username, authorized host for compute node. Format: <username>@<hostname>, hostname is % or empty string means do not care about authorized host</td>
<td>string</td>
<td><code>root@%</code></td>
</tr>
<tr>
<td><code>.spec.authority.users[0].password</code></td>
<td>Username, authorized host for compute node. Format: <username>@<hostname>, hostname is % or empty string means do not care about authorized host</td>
<td>string</td>
<td><code>root@%</code></td>
</tr>
<tr>
<td><code>.spec.authority.priviliege.type</code></td>
<td>Authority priviliege for compute node, the default value is ALL_PRIVILEGES_PERMITTED</td>
<td>string</td>
<td><code>ALL_PRIVILEGES_PERMITTED</code></td>
</tr>
<tr>
<td><code>.spec.props.kernel-executor-size</code></td>
<td>Kernel executor size</td>
<td>number</td>
<td></td>
</tr>
<tr>
<td><code>.spec.props.check-table-metadata-enabled</code></td>
<td>Check table metadata enabled</td>
<td>bool</td>
<td></td>
</tr>
<tr>
<td><code>.spec.props.proxy-backend-query-fetch-size</code></td>
<td>Back end query fetch size</td>
<td>number</td>
<td></td>
</tr>
<tr>
<td><code>.spec.props.check-duplicate-table-enabled</code></td>
<td>Check duplicate table enable</td>
<td>bool</td>
<td></td>
</tr>
<tr>
<td><code>.spec.props.proxy-frontend-executeor-size</code></td>
<td>Front end executor size</td>
<td>number</td>
<td></td>
</tr>
<tr>
<td><code>.spec.props.proxy-backend-executor-suitable</code></td>
<td>Back end executor suitable</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><code>.spec.props.proxy-backend-driver-type</code></td>
<td>Back end driver type</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><code>.spec.props.proxy-frontend-database-protocol-type</code></td>
<td>Front end database protocol type</td>
<td>string</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="examples">Examples</h4>
<p>ShardingSphereProxy example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">shardingsphere.apache.org/v1alpha1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ShardingSphereProxy</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">shardingsphere-cluster-shardingsphere-proxy</span>
  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">shardingsphere-operator</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">version</span>: <span style="color:#ae81ff">5.5.0</span>
  <span style="color:#f92672">serviceType</span>:
    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">ClusterIP</span>
  <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">3</span>
  <span style="color:#f92672">proxyConfigName</span>: <span style="color:#e6db74">&#34;shardingsphere-cluster-shardingsphere-proxy-configuration&#34;</span>
  <span style="color:#f92672">port</span>: <span style="color:#ae81ff">3307</span>
  <span style="color:#f92672">mySQLDriver</span>:
    <span style="color:#f92672">version</span>: <span style="color:#e6db74">&#34;5.1.47&#34;</span>
</code></pre></div><p>ShardingSphereProxyServerConfig example:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">shardingsphere.apache.org/v1alpha1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ShardingSphereProxyServerConfig</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">shardingsphere-cluster-shardingsphere-proxy-configuration</span>
  <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">shardingsphere-operator</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">authority</span>:
    <span style="color:#f92672">privilege</span>:
      <span style="color:#f92672">type</span>: <span style="color:#ae81ff">ALL_PERMITTED</span>
    <span style="color:#f92672">users</span>:
    - <span style="color:#f92672">password</span>: <span style="color:#ae81ff">root</span>
      <span style="color:#f92672">user</span>: <span style="color:#ae81ff">root@%</span>
  <span style="color:#f92672">mode</span>:
    <span style="color:#f92672">repository</span>:
      <span style="color:#f92672">props</span>:
        <span style="color:#f92672">maxRetries</span>: <span style="color:#ae81ff">3</span>
        <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">governance_ds</span>
        <span style="color:#f92672">operationTimeoutMilliseconds</span>: <span style="color:#ae81ff">5000</span>
        <span style="color:#f92672">retryIntervalMilliseconds</span>: <span style="color:#ae81ff">500</span>
        <span style="color:#f92672">server-lists</span>: <span style="color:#e6db74">&#39;shardingsphere-cluster-zookeeper.shardingsphere-operator:2181&#39;</span>
        <span style="color:#f92672">timeToLiveSeconds</span>: <span style="color:#ae81ff">600</span>
      <span style="color:#f92672">type</span>: <span style="color:#ae81ff">ZooKeeper</span>
    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">Cluster</span>
  <span style="color:#f92672">props</span>:
    <span style="color:#f92672">proxy-frontend-database-protocol-type</span>: <span style="color:#ae81ff">MySQL</span>
</code></pre></div><h3 id="computenode">ComputeNode</h3>
<p>ComputeNode describes the computing nodes in the ShardingSphere cluster, usually referred to as Proxy. Since ShardingSphere Proxy is a stateless application, it can be managed using Kubernetes' native workload Deployment, meanwhile using ConfigMap and Service to configure startup configuration and service discovery. Using ComputeNode can not only unify key configurations in Deployment, ConfigMap, and Service, but also match the semantics of ShardingSphere, helping Operators quickly lock workloads. As shown in the picture:</p>
<p><img src="../../../img/user-manual/cn-concepts-1.png" alt=""></p>
<h4 id="operator-configuration">Operator Configuration</h4>
<p>Currently, the Operator use ComputeNode needs to open featureGate that is relevant:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">helm install <span style="color:#f92672">[</span>RELEASE_NAME<span style="color:#f92672">]</span> shardingsphere/apache-shardingsphere-operator-charts --set operator.featureGates.computeNode<span style="color:#f92672">=</span>true --set proxyCluster.enabled<span style="color:#f92672">=</span>false
</code></pre></div><h4 id="column-comment-1">Column Comment</h4>
<h5 id="programmatic-configuration-1">Programmatic Configuration</h5>
<table>
<thead>
<tr>
<th>Configuration item</th>
<th>Description</th>
<th>Type</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>metadata.name</code></td>
<td>Name of deployment plan name</td>
<td>string</td>
<td><code>foo</code></td>
</tr>
<tr>
<td><code>metadata.namespace</code></td>
<td>Default namespace of deployment plan</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><code>spec.storageNodeConnector.type</code></td>
<td>Back end driver type</td>
<td>string</td>
<td><code>mysql</code></td>
</tr>
<tr>
<td><code>spec.storageNodeConnector.version</code></td>
<td>Back end driver version</td>
<td>string</td>
<td><code>5.1.47</code></td>
</tr>
<tr>
<td><code>spec.serverVersion</code></td>
<td>ShardingSphere-Proxy version</td>
<td>string</td>
<td><code>5.5.0</code></td>
</tr>
<tr>
<td><code>spec.replicas </code></td>
<td>Deployment plan instance</td>
<td>number</td>
<td><code>3</code></td>
</tr>
<tr>
<td><code>spec.selectors</code></td>
<td>Instance selector, same as Deployment.Spec.Selectors</td>
<td>number</td>
<td><code>3</code></td>
</tr>
<tr>
<td><code>spec.portBindings[0].name</code></td>
<td>Name of exposed port</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><code>spec.portBindings[0].containerPort</code></td>
<td>Exposed container port</td>
<td>number</td>
<td><code>3307</code></td>
</tr>
<tr>
<td><code>spec.portBindings[0].servicePort</code></td>
<td>Exposed container port</td>
<td>number</td>
<td><code>3307</code></td>
</tr>
<tr>
<td><code>spec.portBindings[0].procotol</code></td>
<td>Exposed port procotol</td>
<td>string</td>
<td><code>TCP</code></td>
</tr>
<tr>
<td><code>spec.serviceType</code></td>
<td>Exposed port type</td>
<td>string</td>
<td><code>ClusterIP</code></td>
</tr>
<tr>
<td><code>spec.bootstrap.serverConfig.authority.privilege.type</code></td>
<td>Authority priviliege for compute node, the default value is ALL_PRIVILEGES_PERMITTED</td>
<td>string</td>
<td><code>ALL_PRIVILEGES_PERMITTED</code></td>
</tr>
<tr>
<td><code>spec.bootstrap.serverConfig.authority.users[0].user</code></td>
<td>Username, authorized host for compute node. Format: <username>@<hostname> hostname is % or empty string means do not care about authorized host</td>
<td>string</td>
<td><code>root@%</code></td>
</tr>
<tr>
<td><code>spec.bootstrap.serverConfig.authority.users[0].password</code></td>
<td>Password of compute node</td>
<td>string</td>
<td><code>root</code></td>
</tr>
<tr>
<td><code>spec.bootstrap.serverConfig.mode.type</code></td>
<td>Type of mode configuration, supports Standalone and Cluster</td>
<td>string</td>
<td><code>Cluster</code></td>
</tr>
<tr>
<td><code>spec.bootstrap.serverConfig.mode.repository.type</code></td>
<td>Type of persist repository, supports ZooKeeper and Etcd</td>
<td>string</td>
<td><code>ZooKeeper</code></td>
</tr>
<tr>
<td><code>spec.bootstrap.serverConfig.mode.repository.props</code></td>
<td>Registry center properties configuration, refer to [Common ServerConfig Repository Props](#Common\ ServerConfig\ Repository\ Props\ Configuration)</td>
<td>map[string]string</td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="common-serverconfig-repository-props-configuration">Common ServerConfig Repository Props Configuration</h5>
<table>
<thead>
<tr>
<th>Configuration item</th>
<th>Description</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>spec.bootstrap.serverConfig.mode.repository.props.timeToLiveSeconds</code></td>
<td>TTL</td>
<td><code>600</code></td>
</tr>
<tr>
<td><code>spec.bootstrap.serverConfig.mode.repository.props.serverlists</code></td>
<td>Server lists of registry center</td>
<td><code>zookeeper.default:2181</code></td>
</tr>
<tr>
<td><code>spec.bootstrap.serverConfig.mode.repository.props.retryIntervalMilliseconds</code></td>
<td>Milliseconds of retry interval</td>
<td><code>500</code></td>
</tr>
<tr>
<td><code>spec.bootstrap.serverConfig.mode.repository.props.operationTimeoutMilliseconds</code></td>
<td>Millisecond of operation timeout</td>
<td><code>5000</code></td>
</tr>
<tr>
<td><code>spec.bootstrap.serverConfig.mode.repository.props.namespace</code></td>
<td>Namespace of registry center(Not namespace of K8s)</td>
<td><code>governance_ds</code></td>
</tr>
<tr>
<td><code>spec.bootstrap.serverConfig.mode.repository.props.maxRetries</code></td>
<td>Max retries of client connection</td>
<td><code>3</code></td>
</tr>
</tbody>
</table>
<h5 id="optional-configuration-1">Optional Configuration</h5>
<table>
<thead>
<tr>
<th>Configuration item</th>
<th>Description</th>
<th>Type</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>spec.probes.livenessProbe</code></td>
<td>Liveness probe</td>
<td>corev1.Probe</td>
<td></td>
</tr>
<tr>
<td><code>spec.probes.readinessProbe</code></td>
<td>Readiness probe</td>
<td>corev1.Probe</td>
<td></td>
</tr>
<tr>
<td><code>spec.probes.startupProbe</code></td>
<td>Startup probe</td>
<td>corev1.Probe</td>
<td></td>
</tr>
<tr>
<td><code>spec.imgaePullSecrets </code></td>
<td>Image pull secrets</td>
<td>corev1.LocalObjectReference</td>
<td></td>
</tr>
<tr>
<td><code>spec.env</code></td>
<td>Environment variable</td>
<td>corev1.Env</td>
<td></td>
</tr>
<tr>
<td><code>spec.resources</code></td>
<td>Resources</td>
<td>corev1.ResourceRequirements</td>
<td></td>
</tr>
<tr>
<td><code>spec.bootstrap.agentConfig.plugins.logging.file.props</code></td>
<td>Agent configuration plugins logging file properties</td>
<td>map[string]string</td>
<td></td>
</tr>
<tr>
<td><code>spec.bootstrap.agentConfig.plugins.metrics.prometheus.host</code></td>
<td>Agent configuration plugins metrics prometheus host</td>
<td>map[string]string</td>
<td></td>
</tr>
<tr>
<td><code>spec.bootstrap.agentConfig.plugins.metrics.prometheus.port</code></td>
<td>Agent configuration plugins metrics prometheus port</td>
<td>map[string]string</td>
<td></td>
</tr>
<tr>
<td><code>spec.bootstrap.agentConfig.plugins.metrics.prometheus.props</code></td>
<td>Agent configuration plugins metrics prometheus properties</td>
<td>map[string]string</td>
<td></td>
</tr>
<tr>
<td><code>spec.bootstrap.agentConfig.plugins.tracing.openTracing.props</code></td>
<td>Agent configuration plugins tracing opentracing properties</td>
<td>map[string]string</td>
<td></td>
</tr>
<tr>
<td><code>spec.bootstrap.agentConfig.plugins.tracing.openTelemetry.props</code></td>
<td>Agent configuration plugins tracing opentelemetry properties</td>
<td>map[string]string</td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="instance-configuration">Instance Configuration</h4>
<p>The following is a basic instance configuration of ComputeNode CRD, which can pull up a three-node file server cluster in ShardingSphere Proxy.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">shardingsphere.apache.org/v1alpha1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">ComputeNode</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">labels</span>:
    <span style="color:#f92672">app</span>: <span style="color:#ae81ff">foo</span>
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">foo</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">storageNodeConnector</span>:
    <span style="color:#f92672">type</span>: <span style="color:#ae81ff">mysql</span>
    <span style="color:#f92672">version</span>: <span style="color:#ae81ff">5.1.47</span>
  <span style="color:#f92672">serverVersion</span>: <span style="color:#ae81ff">5.5.0</span>
  <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">3</span>
  <span style="color:#f92672">selector</span>:
    <span style="color:#f92672">matchLabels</span>:
      <span style="color:#f92672">app</span>: <span style="color:#ae81ff">foo</span>
  <span style="color:#f92672">portBindings</span>:
  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">server</span>
    <span style="color:#f92672">containerPort</span>: <span style="color:#ae81ff">3307</span>
    <span style="color:#f92672">servicePort</span>: <span style="color:#ae81ff">3307</span>
    <span style="color:#f92672">protocol</span>: <span style="color:#ae81ff">TCP</span>
  <span style="color:#f92672">serviceType</span>: <span style="color:#ae81ff">ClusterIP</span>
  <span style="color:#f92672">bootstrap</span>:
    <span style="color:#f92672">serverConfig</span>:
      <span style="color:#f92672">authority</span>:
        <span style="color:#f92672">privilege</span>:
          <span style="color:#f92672">type</span>: <span style="color:#ae81ff">ALL_PERMITTED</span>
        <span style="color:#f92672">users</span>:
        - <span style="color:#f92672">user</span>: <span style="color:#ae81ff">root@%</span>
          <span style="color:#f92672">password</span>: <span style="color:#ae81ff">root</span>
      <span style="color:#f92672">mode</span>:
        <span style="color:#f92672">type</span>: <span style="color:#ae81ff">Cluster</span>
        <span style="color:#f92672">repository</span>:
          <span style="color:#f92672">type</span>: <span style="color:#ae81ff">ZooKeeper</span>
          <span style="color:#f92672">props</span>:
            <span style="color:#f92672">timeToLiveSeconds</span>: <span style="color:#e6db74">&#34;600&#34;</span>
            <span style="color:#f92672">server-lists</span>: <span style="color:#ae81ff">${PLEASE_REPLACE_THIS_WITH_YOUR_ZOOKEEPER_SERVICE}</span>
            <span style="color:#f92672">retryIntervalMilliseconds</span>: <span style="color:#e6db74">&#34;500&#34;</span>
            <span style="color:#f92672">operationTimeoutMilliseconds</span>: <span style="color:#e6db74">&#34;5000&#34;</span>
            <span style="color:#f92672">namespace</span>: <span style="color:#ae81ff">governance_ds</span>
            <span style="color:#f92672">maxRetries</span>: <span style="color:#e6db74">&#34;3&#34;</span>
      <span style="color:#f92672">props</span>:
        <span style="color:#f92672">proxy-frontend-database-protocol-type</span>: <span style="color:#ae81ff">MySQL</span>
</code></pre></div><p>Note:  A ZooKeeper cluster in normal operation is a prerequisite.</p>
<h3 id="storagenode">StorageNode</h3>
<p>StorageNode is the Operator&rsquo;s description of the data source and provides data source lifecycle management. Its use needs to cooperate with StorageProvider, and now supports AWS RDS and CloudNative PG. As shown in the picture:</p>
<p><img src="../../../img/user-manual/sn-concepts-1.png" alt=""></p>
<p>Note: StorageNode is an optional CRD, and users can decide whether to manage data sources through StorageNode depending on real situation.</p>
<h4 id="operator-configuration-1">Operator Configuration</h4>
<p>Currently, the Operator use StorageNode needs to open featureGate that is relevant:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">helm install <span style="color:#f92672">[</span>RELEASE_NAME<span style="color:#f92672">]</span> shardingsphere/apache-shardingsphere-operator-charts --set operator.featureGates.storageNode<span style="color:#f92672">=</span>true --set operator.storageNodeProviders.aws.region<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span> --set operator.storageNodeProviders.aws.accessKeyId<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span> --set operator.storageNodeProviders.aws.secretAccessKey<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span> --set operator.storageNodeProviders.aws.enabled<span style="color:#f92672">=</span>true
</code></pre></div><h4 id="column-comment-2">Column Comment</h4>
<h5 id="programmatic-configuration-2">Programmatic Configuration</h5>
<table>
<thead>
<tr>
<th>Configuration items</th>
<th>Description</th>
<th>Type</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>metadata.name</code></td>
<td>Name of deployment plan</td>
<td>string</td>
<td><code>foo</code></td>
</tr>
<tr>
<td><code>metadata.namespace</code></td>
<td>Default namespace of deployment plan</td>
<td>string</td>
<td></td>
</tr>
<tr>
<td><code>spec.storageProviderName</code></td>
<td>Name of provisioner</td>
<td>string</td>
<td><code>aws-rds-instance</code></td>
</tr>
</tbody>
</table>
<h5 id="optional-configuration-2">Optional Configuration</h5>
<table>
<thead>
<tr>
<th>Configuration item</th>
<th>Description</th>
<th>Type</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>spec.storageProviderSchema</code></td>
<td>Schema initialize</td>
<td>string</td>
<td><code>sharding_db</code></td>
</tr>
<tr>
<td><code>spec.replicas</code></td>
<td>Aurora cluster size</td>
<td>number</td>
<td>2</td>
</tr>
</tbody>
</table>
<h4 id="examples-1">Examples</h4>
<p>The following is a StorageNode configuration introduction for AWS RDS Aurora, which can pull up Aurora cluster:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">shardingsphere.apache.org/v1alpha1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">StorageNode</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">storage-node-with-aurora-example</span>
  <span style="color:#f92672">annotations</span>:
    <span style="color:#f92672">&#34;storageproviders.shardingsphere.apache.org/cluster-identifier&#34;: </span><span style="color:#e6db74">&#34;storage-node-with-aurora-example&#34;</span>
    <span style="color:#f92672">&#34;storageproviders.shardingsphere.apache.org/instance-db-name&#34;: </span><span style="color:#e6db74">&#34;test_db&#34;</span>
    <span style="color:#75715e"># The following annotations are required for auto registration.</span>
    <span style="color:#f92672">&#34;shardingsphere.apache.org/register-storage-unit-enabled&#34;: </span><span style="color:#e6db74">&#34;false&#34;</span> <span style="color:#75715e"># If it needs auto registration, please set up &#39;true&#39;.</span>
    <span style="color:#f92672">&#34;shardingsphere.apache.org/logic-database-name&#34;: </span><span style="color:#e6db74">&#34;sharding_db&#34;</span>
    <span style="color:#f92672">&#34;shardingsphere.apache.org/compute-node-name&#34;: </span><span style="color:#e6db74">&#34;shardingsphere-operator-shardingsphere-proxy&#34;</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">schema</span>: <span style="color:#e6db74">&#34;test_db&#34;</span>
  <span style="color:#f92672">storageProviderName</span>: <span style="color:#ae81ff">aws-aurora-cluster-mysql-5.7</span>
  <span style="color:#f92672">replicas</span>: <span style="color:#ae81ff">2</span> <span style="color:#75715e"># Currently, only AWS Aurora is efficient.</span>
</code></pre></div><h3 id="storageprovider">StorageProvider</h3>
<p>StorageProvider declares some different suppliers of StorageNode, such as AWS RDS and CloudNative PG.</p>
<h4 id="column-comment-3">Column Comment</h4>
<h5 id="programmatic-configuration-3">Programmatic Configuration</h5>
<table>
<thead>
<tr>
<th>Configuration item</th>
<th>Descrption</th>
<th>Type</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>metadata.name</code></td>
<td>Name of deployment plan</td>
<td>string</td>
<td><code>foo</code></td>
</tr>
<tr>
<td><code>spec.storageProviderName</code></td>
<td>Name of provisioner</td>
<td>string</td>
<td><code>aws-rds-instance</code></td>
</tr>
</tbody>
</table>
<h4 id="examples-2">Examples</h4>
<p>The following declares a StorageProvider in AWS Aurora, including the setting of relevant features:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">shardingsphere.apache.org/v1alpha1</span>
<span style="color:#f92672">kind</span>: <span style="color:#ae81ff">StorageProvider</span>
<span style="color:#f92672">metadata</span>:
  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">aws-aurora-cluster-mysql-5.7</span>
<span style="color:#f92672">spec</span>:
  <span style="color:#f92672">provisioner</span>: <span style="color:#ae81ff">storageproviders.shardingsphere.apache.org/aws-aurora</span>
  <span style="color:#f92672">reclaimPolicy</span>: <span style="color:#ae81ff">Delete</span>
  <span style="color:#f92672">parameters</span>:
    <span style="color:#f92672">masterUsername</span>: <span style="color:#e6db74">&#34;root&#34;</span>
    <span style="color:#f92672">masterUserPassword</span>: <span style="color:#e6db74">&#34;root123456&#34;</span>
    <span style="color:#f92672">instanceClass</span>: <span style="color:#e6db74">&#34;db.t3.small&#34;</span>
    <span style="color:#f92672">engine</span>: <span style="color:#e6db74">&#34;aurora-mysql&#34;</span>
    <span style="color:#f92672">engineVersion</span>: <span style="color:#e6db74">&#34;5.7&#34;</span>
</code></pre></div><h2 id="clean">Clean</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">helm uninstall shardingsphere-cluster -n shardingsphere-operator
</code></pre></div><h2 id="next">Next</h2>
<p>To use the created ShardingSphere-Proxy cluster, you need to use <a href="https://shardingsphere.apache.org/document/current/cn/user-manual/shardingsphere-proxy/distsql/usage/">DistSQL</a> to configure corresponding resources and rules, such as database resources, sharding rules, etc.</p>


<footer class=" footline" >
	
</footer>

        
            </div> 
        
        </div> 
        

      </div>

    <div id="navigation" >
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


        
            
                <a class="nav nav-prev" href="https://shardingsphere.apache.org/oncloud/current/en/user-manual/helm/" title="ShardingSphere Helm Charts User Manual"> <i class="fa fa-long-arrow-left fa-lg"></i> Previous</a>
            
        
        
            
                <a class="nav nav-next" href="https://shardingsphere.apache.org/oncloud/current/en/user-manual/cloudformation-multi-az/" title="CloudFormation Deploys ShardingSphere Proxy Cluster in Multiple AZs" style="margin-right: 0px;">Next<i class="fa fa-long-arrow-right fa-lg"></i></a>
            
        
    </div>

    </section>
</div>
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    
    <script src="https://shardingsphere.apache.org/oncloud/current/js/clipboard.min.js?1715643766"></script>
    <script src="https://shardingsphere.apache.org/oncloud/current/js/perfect-scrollbar.min.js?1715643766"></script>
    <script src="https://shardingsphere.apache.org/oncloud/current/js/perfect-scrollbar.jquery.min.js?1715643766"></script>
    <script src="https://shardingsphere.apache.org/oncloud/current/js/jquery.sticky.js?1715643766"></script>
    <script src="https://shardingsphere.apache.org/oncloud/current/js/featherlight.min.js?1715643766"></script>
    <script src="https://shardingsphere.apache.org/oncloud/current/js/html5shiv-printshiv.min.js?1715643766"></script>
    <script src="https://shardingsphere.apache.org/oncloud/current/js/highlight.pack.js?1715643766"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://shardingsphere.apache.org/oncloud/current/js/modernizr.custom.71422.js?1715643766"></script>
    <script src="https://shardingsphere.apache.org/oncloud/current/js/learn.js?1715643766"></script>
    <script src="https://shardingsphere.apache.org/oncloud/current/js/hugo-learn.js?1715643766"></script>
    <script>
        try{

            function log(fileName, category, locale){
                window._hmt.push(['_trackEvent', 'document', 'download', locale ? 'PDF_'+locale : fileName]);

                gtag('event', 'Downloads', {
                    'event_category' : locale ? 'PDF' : category,
                    'event_label' : locale ? locale+'.pdf' : fileName
                });
            }
            
            $('.padding[href*=shardingsphere]').on('click', function(){
                var locale = /cn/.test(location.pathname) ?'cn':'en';
                log('','', locale)
            })

            function getFileName(str){
                var strs = str.split('/');
                return strs[strs.length - 1]
            }

            $('a[href$="src.zip"]').on('click', function(){
                log(getFileName($(this).attr('href')), "SRC")
            })

            $('a[href$="zip.asc"]').on('click', function(){
                log(getFileName($(this).attr('href')), "ASC")
            })
            
            $('a[href$="zip.sha512"]').on('click', function(){
                log(getFileName($(this).attr('href')), "SHA512")
            })

            $('a[href$="tar.gz.asc"]').on('click', function(){
                log(getFileName($(this).attr('href')), "ASC")
            })
            
            $('a[href$="tar.gz.sha512"]').on('click', function(){
                log(getFileName($(this).attr('href')), "SHA512")
            })

            $('a[href$="tar.gz"]').on('click', function(){
                log(getFileName($(this).attr('href')), "TAR")
            })

        }catch(ex){}
    </script>
    

  </body>
</html>

