1,3c1,3
< commit faa4ff60876f5e403e61547d415364b43b238613
< Author: Zhengqiang Duan <strongduanmu@gmail.com>
< Date:   Sat Nov 7 16:15:41 2020 +0800
---
> commit e71e4b6d0f9d8f0feba13695e79ac44b2f40e01d
> Author: kimmking <kimmking@163.com>
> Date:   Mon Nov 9 14:07:59 2020 +0800
5c5
<     update the subquery document (#8064)
---
>     add docker build to shardingsphere-ui release note (#8086)
7,26c7,12
< diff --git a/docs/document/content/features/sharding/use-norms/sql.cn.md b/docs/document/content/features/sharding/use-norms/sql.cn.md
< index 7d1d4d8601..4cfa3f0df7 100644
< --- a/docs/document/content/features/sharding/use-norms/sql.cn.md
< +++ b/docs/document/content/features/sharding/use-norms/sql.cn.md
< @@ -55,20 +55,23 @@ tbl_name [AS] alias] [index_hint_list]
<  不支持 HAVING、UNION (ALL)
<  
<  部分支持子查询
< -* 子查询中必须包含分片键，且分片键必须和父查询中的分片键一致
< +* 子查询中使用WHERE条件时，必须包含分片键，当外层查询中也包含分片键时，子查询和外层查询中的分片键必须保持一致
<  
<  除了分页子查询的支持之外(详情请参考[分页](/cn/features/sharding/use-norms/pagination))，也支持同等模式的子查询。无论嵌套多少层，ShardingSphere都可以解析至第一个包含数据表的子查询，一旦在下层嵌套中再次找到包含数据表的子查询将直接抛出解析异常。
<  
<  例如，以下子查询可以支持：
<  
<  ```sql
< -SELECT COUNT(*) FROM (SELECT * FROM t_order o where id>10) where id>10;
< +SELECT COUNT(*) FROM (SELECT * FROM t_order) o;
< +SELECT COUNT(*) FROM (SELECT * FROM t_order WHERE order_id = 1) o;
< +SELECT COUNT(*) FROM (SELECT * FROM t_order WHERE order_id = 1) o WHERE o.order_id = 1;
---
> diff --git a/docs/community/content/contribute/release_ui.cn.md b/docs/community/content/contribute/release_ui.cn.md
> index c75b5bf916..c97786bc86 100644
> --- a/docs/community/content/contribute/release_ui.cn.md
> +++ b/docs/community/content/contribute/release_ui.cn.md
> @@ -352,13 +352,47 @@ git push --delete origin ${RELEASE.VERSION}-release
>  git branch -d ${RELEASE.VERSION}-release
29,34c15,75
<  以下子查询不支持：
<  
<  ```sql
< -SELECT COUNT(*) FROM (SELECT * FROM t_order o)
< +SELECT COUNT(*) FROM (SELECT * FROM t_order WHERE product_id = 1) o;
< +SELECT COUNT(*) FROM (SELECT * FROM t_order WHERE order_id = 1) o WHERE o.order_id = 2;
---
> -**3. GitHub 版本发布**
> +**3. 发布 Docker**
> +
> +3.1 准备工作
> +
> +本地安装 Docker，并启动服务。
> +
> +3.2 编译 Docker 镜像
> +
> +```shell
> +git checkout ${RELEASE.VERSION}
> +cd ~/shardingsphere-ui/shardingsphere-ui-distribution/shardingsphere-ui-bin-distribution/
> +mvn clean package -Prelease,docker
> +```
> +
> +3.3 给本地 Docker 镜像打标记
> +
> +通过`docker images`查看到IMAGE ID，例如为：e9ea51023687
> +
> +```shell
> +docker tag e9ea51023687 apache/shardingsphere-ui:latest
> +docker tag e9ea51023687 apache/shardingsphere-ui:${RELEASE.VERSION}
> +```
> +
> +3.4 发布Docker镜像
> +
> +```shell
> +docker push apache/shardingsphere-ui:latest
> +docker push apache/shardingsphere-ui:${RELEASE_VERSION}
> +```
> +
> +3.5 确认发布成功
> +
> +登录 [Docker Hub](https://hub.docker.com/r/apache/shardingsphere-ui/) 查看是否有发布的镜像
> +
> +**4. GitHub 版本发布**
>  
>  在 [GitHub Releases](https://github.com/apache/shardingsphere-ui/releases) 页面的 `shardingsphere-ui-${RELEASE_VERSION}` 版本上点击 `Edit`
>  
>  编辑版本号及版本说明，并点击 `Publish release`
>  
> -**4. 更新下载页面**
> +**5. 更新下载页面**
>  
>  等待并确认新的发布版本同步至 Apache 镜像后，更新如下页面：
>  
> @@ -370,7 +404,7 @@ GPG签名文件和哈希校验文件的下载连接应该使用这个前缀： `
>  
>  `最新版本`中保留一个最新的版本。Incubator阶段历史版本会自动归档到[Archive repository](https://archive.apache.org/dist/incubator/shardingsphere/)
>  
> -**5. 邮件通知版本发布完成**
> +**6. 邮件通知版本发布完成**
>  
>  ## 发送邮件到`dev@shardingsphere.apache.org`和`announce@apache.org`通知完成版本发布
>  
> diff --git a/docs/community/content/contribute/release_ui.en.md b/docs/community/content/contribute/release_ui.en.md
> index 7e200f9c91..8c38dfcdba 100644
> --- a/docs/community/content/contribute/release_ui.en.md
> +++ b/docs/community/content/contribute/release_ui.en.md
> @@ -356,13 +356,47 @@ git push --delete origin ${RELEASE.VERSION}-release
>  git branch -d ${RELEASE.VERSION}-release
37,58c78,122
<  简单来说，通过子查询进行非功能需求，在大部分情况下是可以支持的。比如分页、统计总数等；而通过子查询实现业务查询当前并不能支持。
< diff --git a/docs/document/content/features/sharding/use-norms/sql.en.md b/docs/document/content/features/sharding/use-norms/sql.en.md
< index fc7eb13da6..4d9a9bf04d 100644
< --- a/docs/document/content/features/sharding/use-norms/sql.en.md
< +++ b/docs/document/content/features/sharding/use-norms/sql.en.md
< @@ -55,20 +55,23 @@ Partially support CASE WHEN
<  
<  Do not support HAVING and UNION (ALL) 
<  Partly available sub-query
< -* If there is a subquery, it needs sharding key condition and be consistent with the parent query.
< +* If subquery contains `WHERE` condition, the sharding key must be included. If the outer query also contains the sharding key, the sharding key in subquery and outer query must be consistent.
<  
<  Support not only pagination sub-query (see [pagination](https://shardingsphere.apache.org/document/current/cn/features/sharding/usage-standard/pagination) for more details), but also sub-query with the same mode. No matter how many layers are nested, ShardingSphere can parse to the first sub-query that contains data table. Once it finds another sub-query of this kind in the sub-level nested, it will directly throw a parsing exception.
<  
<  For example, the following sub-query is available:
<  
<  ```sql
< -SELECT COUNT(*) FROM (SELECT * FROM t_order o where id>10) where id>10;
< +SELECT COUNT(*) FROM (SELECT * FROM t_order) o;
< +SELECT COUNT(*) FROM (SELECT * FROM t_order WHERE order_id = 1) o;
< +SELECT COUNT(*) FROM (SELECT * FROM t_order WHERE order_id = 1) o WHERE o.order_id = 1;
<  ```
---
> -**3. Publish release in GitHub**
> +**3. Docker Release**
> +
> +3.1 Preparation
> +
> +Install and start docker service
> +
> +3.2 Compile Docker Image
> +
> +```shell
> +git checkout ${RELEASE.VERSION}
> +cd ~/shardingsphere-ui/shardingsphere-ui-distribution/shardingsphere-ui-bin-distribution/
> +mvn clean package -Prelease,docker
> +```
> +
> +3.3 Tag the local Docker Image
> +
> +Check the image ID through `docker images`, for example: e9ea51023687
> +
> +```shell
> +docker tag e9ea51023687 apache/shardingsphere-ui:latest
> +docker tag e9ea51023687 apache/shardingsphere-ui:${RELEASE.VERSION}
> +```
> +
> +3.4 Publish Docker Image
> +
> +```shell
> +docker push apache/shardingsphere-ui:latest
> +docker push apache/shardingsphere-ui:${RELEASE_VERSION}
> +```
> +
> +3.5 Confirm the successful release
> +
> +Login [Docker Hub](https://hub.docker.com/r/apache/shardingsphere-ui/) to check whether there are published images
> +
> +**4. Publish release in GitHub**
>  
>  Click `Edit` in [GitHub Releases](https://github.com/apache/shardingsphere-ui/releases)'s `shardingsphere-ui-${RELEASE_VERSION}` version
>  
>  Edit version number and release notes, click `Publish release`
>  
> -**4. Update the download page**
> +**5. Update the download page**
>  
>  https://shardingsphere.apache.org/document/current/en/downloads/
60c124
<  The following sub-query is unavailable:
---
> @@ -372,7 +406,7 @@ GPG signatures and hashes (SHA* etc) should use URL start with `https://download
62,66c126,131
<  ```sql
< -SELECT COUNT(*) FROM (SELECT * FROM t_order o)
< +SELECT COUNT(*) FROM (SELECT * FROM t_order WHERE product_id = 1) o;
< +SELECT COUNT(*) FROM (SELECT * FROM t_order WHERE order_id = 1) o WHERE o.order_id = 2;
<  ```
---
>  Keep one latest versions in `Latest releases`. Incubating stage versions will be archived automatically in [Archive repository](https://archive.apache.org/dist/incubator/shardingsphere/)
>  
> -**5. Announce release completed by email**
> +**6. Announce release completed by email**
>  
>  Send e-mail to `dev@shardingsphere.apache.org` and `announce@apache.org` to announce the release is finished
68d132
<  To be simple, through sub-query, non-functional requirements are available in most cases, such as pagination, sum count and so on; but functional requirements are unavailable for now.
