<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.70.0" />
    <meta name="description" content="">
    <meta name="buildDate" content="2022-12-06 17:43:18">


    <link rel="shortcut icon" href="https://shardingsphere.apache.org/document/current/img/favicon.png" type="image/x-icon" />

    <title>Terraform Deploys ShardingSphere Cluster in Multiple AZs :: ShardingSphereOnCloud</title>
    
    
    <link href="https://shardingsphere.apache.org/oncloud/0.1.1/css/nucleus.css?1670319798" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/0.1.1/css/font-awesome.min.css?1670319798" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/0.1.1/css/hybrid.css?1670319798" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/0.1.1/css/featherlight.min.css?1670319798" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/0.1.1/css/perfect-scrollbar.min.css?1670319798" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/0.1.1/css/auto-complete.css?1670319798" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/0.1.1/css/theme.css?1670319798" rel="stylesheet">
    <link href="https://shardingsphere.apache.org/oncloud/0.1.1/css/hugo-theme.css?1670319798" rel="stylesheet">
    
      <link href="https://shardingsphere.apache.org/oncloud/0.1.1/css/theme-white.css?1670319798" rel="stylesheet">
    

    <script src="https://shardingsphere.apache.org/oncloud/0.1.1/js/jquery-2.x.min.js?1670319798"></script>
    
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?d5a1dc8dcf63a64ee55b80de01c7fb1a";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();   
    </script>
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HETCF66YL0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){window.dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-HETCF66YL0');
    </script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{ 
          display:none !important;
      }
      
      
      
    </style>
    

  </head>
  <body class="" data-url="/en/operation-guide/using-terraform-to-deploy-multi-az/">
    <div class="change-theme">
    <div class="wrap">
        
        <span data-item="retro">
            <svg t="1649761460834" class="icon" viewBox="0 0 1243 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2052" width="16" height="16"><path d="M755.093336 61.436797a511.973304 511.973304 0 1 0 207.495466 693.650688l-99.615377-53.757197a398.827204 398.827204 0 1 1-161.637286-540.351253l53.757197-99.615378z" fill="#ffffff" p-id="2053"></path><path d="M1204.971593 188.84501L534.652259 736.217612l-285.242269-364.086159 86.304071-67.653615 216.199012 275.953611 583.649567-476.574007 69.335813 84.987568z" fill="#ffffff" p-id="2054"></path></svg>
            Retro
        </span>
        <span data-item="eyehelp">
            <svg t="1649761460834" class="icon" viewBox="0 0 1243 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2052" width="16" height="16"><path d="M755.093336 61.436797a511.973304 511.973304 0 1 0 207.495466 693.650688l-99.615377-53.757197a398.827204 398.827204 0 1 1-161.637286-540.351253l53.757197-99.615378z" fill="#ffffff" p-id="2053"></path><path d="M1204.971593 188.84501L534.652259 736.217612l-285.242269-364.086159 86.304071-67.653615 216.199012 275.953611 583.649567-476.574007 69.335813 84.987568z" fill="#ffffff" p-id="2054"></path></svg>
            Eye care
        </span>
        <span data-item="haitian">
            <svg t="1649761460834" class="icon" viewBox="0 0 1243 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2052" width="16" height="16"><path d="M755.093336 61.436797a511.973304 511.973304 0 1 0 207.495466 693.650688l-99.615377-53.757197a398.827204 398.827204 0 1 1-161.637286-540.351253l53.757197-99.615378z" fill="#ffffff" p-id="2053"></path><path d="M1204.971593 188.84501L534.652259 736.217612l-285.242269-364.086159 86.304071-67.653615 216.199012 275.953611 583.649567-476.574007 69.335813 84.987568z" fill="#ffffff" p-id="2054"></path></svg>
            Haitian
        </span>
        <span data-item="deep">
            <svg t="1649761460834" class="icon" viewBox="0 0 1243 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2052" width="16" height="16"><path d="M755.093336 61.436797a511.973304 511.973304 0 1 0 207.495466 693.650688l-99.615377-53.757197a398.827204 398.827204 0 1 1-161.637286-540.351253l53.757197-99.615378z" fill="#ffffff" p-id="2053"></path><path d="M1204.971593 188.84501L534.652259 736.217612l-285.242269-364.086159 86.304071-67.653615 216.199012 275.953611 583.649567-476.574007 69.335813 84.987568z" fill="#ffffff" p-id="2054"></path></svg>
            Deep
        </span>
        <span data-item="dark">
            <svg t="1649761460834" class="icon" viewBox="0 0 1243 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2052" width="16" height="16"><path d="M755.093336 61.436797a511.973304 511.973304 0 1 0 207.495466 693.650688l-99.615377-53.757197a398.827204 398.827204 0 1 1-161.637286-540.351253l53.757197-99.615378z" fill="#ffffff" p-id="2053"></path><path d="M1204.971593 188.84501L534.652259 736.217612l-285.242269-364.086159 86.304071-67.653615 216.199012 275.953611 583.649567-476.574007 69.335813 84.987568z" fill="#ffffff" p-id="2054"></path></svg>
            Dark
        </span>
        <span class="active">
            <svg t="1649761460834" class="icon" viewBox="0 0 1243 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2052" width="16" height="16"><path d="M755.093336 61.436797a511.973304 511.973304 0 1 0 207.495466 693.650688l-99.615377-53.757197a398.827204 398.827204 0 1 1-161.637286-540.351253l53.757197-99.615378z" fill="#ffffff" p-id="2053"></path><path d="M1204.971593 188.84501L534.652259 736.217612l-285.242269-364.086159 86.304071-67.653615 216.199012 275.953611 583.649567-476.574007 69.335813 84.987568z" fill="#ffffff" p-id="2054"></path></svg>
            Default
        </span>
        
    </div>
</div>



    <header>
      <div class="wrap">
        <a href="https://shardingsphere.apache.org/"><img src="https://shardingsphere.apache.org/document/current/img/logo_v3.png" /></a>

        
        

        
        
        <section id="prefooter">
          
          <ul>
          
            <li>
              <a class="padding">
                <i class="fa fa-fw fa-language"></i>
              <div class="select-style">
                <select id="select-language" onchange="location = this.value;">
              
              
              
                  
                  
                      
                        
                        
                          <option id="en" value="https://shardingsphere.apache.org/oncloud/0.1.1/en/operation-guide/using-terraform-to-deploy-multi-az/" selected>English</option>
                        
                      
                  
                      
                  
              
                  
                  
                      
                  
                      
                        
                        
                          <option id="cn" value="https://shardingsphere.apache.org/oncloud/0.1.1/cn/operation-guide/using-terraform-to-deploy-multi-az/">简体中文</option>
                        
                      
                  
              
            </select>
            <svg t="1645437162166" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2449" width="32" height="32"><path d="M483.072 714.496l30.165333 30.208 415.957334-415.829333a42.837333 42.837333 0 0 0 0-60.288 42.538667 42.538667 0 0 0-60.330667-0.042667l-355.541333 355.413333-355.242667-355.413333a42.496 42.496 0 0 0-60.288 0 42.837333 42.837333 0 0 0-0.085333 60.330667l383.701333 383.872 1.706667 1.749333z" fill="#3D3D3D" p-id="2450"></path></svg>
            </div>
            </a>
            </li>
           
          
          
          </ul>
        </section>
        
      </div>
    </header>
    <div class="wrap">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    
    
        <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>

<script type="text/javascript" src="https://shardingsphere.apache.org/oncloud/0.1.1/js/lunr.min.js?1670319798"></script>
<script type="text/javascript" src="https://shardingsphere.apache.org/oncloud/0.1.1/js/auto-complete.js?1670319798"></script>
<script type="text/javascript">
    
        var baseurl = "\/en";
    
</script>
<script type="text/javascript" src="https://shardingsphere.apache.org/oncloud/0.1.1/js/search.js?1670319798"></script>

    
  </div>

    <div class="highlightable">
    <div class="leftMenu">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/en/overview/" title="Overview" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/0.1.1/en/overview/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>1. </b>Overview
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/en/features/" title="Features" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/0.1.1/en/features/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>2. </b>Features
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/en/operation-guide/" title="Operation Guide" class="dd-item 
        parent
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/0.1.1/en/operation-guide/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
             <svg  class="icon icon-down" 
              style="display: inline-block;"
              viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"   width="20" height="20" fill="#777">
              <path d="M500.8 604.778667L267.306667 371.392l-45.226667 45.269333 278.741333 278.613334 278.485334-278.613334-45.248-45.248z" p-id="5376" ></path>
            </svg>
            <svg  class="icon icon-right" 
              style="display: none;"
              viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"  width="20" height="20" fill="#777">
              <path d="M593.450667 512.128L360.064 278.613333l45.290667-45.226666 278.613333 278.762666L405.333333 790.613333l-45.226666-45.269333z" p-id="5605" ></path>
            </svg>
          
          </i>
          <b>3. </b>Operation Guide
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/en/operation-guide/helm/" title="ShardingSphere Helm Charts User Manual" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/0.1.1/en/operation-guide/helm/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>3.1 </b>ShardingSphere Helm Charts User Manual
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/operation-guide/operator/" title="ShardingSphere-Operator User Manual" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/0.1.1/en/operation-guide/operator/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>3.2 </b>ShardingSphere-Operator User Manual
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/operation-guide/using-cloudformation-to-start-proxy/" title="Start ShardingSphere Proxy with CloudFormation " class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/0.1.1/en/operation-guide/using-cloudformation-to-start-proxy/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>3.3 </b>Start ShardingSphere Proxy with CloudFormation 
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/operation-guide/cloudformation-multi-az/" title="CloudFormation Deploys ShardingSphere Proxy Cluster in Multiple AZs" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/0.1.1/en/operation-guide/cloudformation-multi-az/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>3.4 </b>CloudFormation Deploys ShardingSphere Proxy Cluster in Multiple AZs
          
      </a>
      
              
    </li>
  
 

            
          
            
            


 
  
    
    <li data-nav-id="/en/operation-guide/using-terraform-to-deploy-multi-az/" title="Terraform Deploys ShardingSphere Cluster in Multiple AZs" class="dd-item 
        parent
        active
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/0.1.1/en/operation-guide/using-terraform-to-deploy-multi-az/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>3.5 </b>Terraform Deploys ShardingSphere Cluster in Multiple AZs
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/en/best-practices/" title="Best Practices" class="dd-item 
        
        
        
        ">
            
      <a href="https://shardingsphere.apache.org/oncloud/0.1.1/en/best-practices/">
         <i class="collapse" style="display:inline; font-family:'courier';">
         
            <svg  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5375" width="20" height="20"></svg>
          
          </i>
          <b>4. </b>Best Practices
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
    
    </div>
    

    

    <section id="footer">
      <p></p>
    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='https://shardingsphere.apache.org/oncloud/0.1.1/en/'>ShardingSphereOnCloud</a> > <a href='https://shardingsphere.apache.org/oncloud/0.1.1/en/operation-guide/'>Operation Guide</a> > Terraform Deploys ShardingSphere Cluster in Multiple AZs
          
         
          
         
          
           
                  </span>
                </div>
                
              </div>
            </div>
            

        
          <div id="chapter">
        
        <div id="body-inner">
          

        


<nav id="TableOfContents">
  <ul>
    <li><a href="#background">Background</a></li>
    <li><a href="#goal">Goal</a></li>
    <li><a href="#quick-start">Quick Start</a>
      <ul>
        <li><a href="#requirements">Requirements</a></li>
        <li><a href="#procedure">Procedure</a></li>
      </ul>
    </li>
    <li><a href="#user-manual">User Manual</a>
      <ul>
        <li><a href="#dependency">Dependency</a></li>
        <li><a href="#module-list">Module List</a></li>
        <li><a href="#outputs">Outputs</a></li>
        <li><a href="#module-details">Module Details</a></li>
      </ul>
    </li>
    <li><a href="#devops">DevOps</a>
      <ul>
        <li><a href="#zookeeper">ZooKeeper</a></li>
        <li><a href="#shardingsphere-proxy">ShardingSphere Proxy</a></li>
      </ul>
    </li>
  </ul>
</nav>

<h2 id="background">Background</h2>
<p>Terraform is an open source automated infrastructure orchestration tool, which uses the concept of &ldquo;infrastructure as code&rdquo; to manage infrastructure changes. Public cloud providers such as AWS, Google Cloud Platform (GCP), Azure, Alibaba Cloud, and Ucloud support it, as well as various community-supported providers have become a standard in the field of &ldquo;infrastructure is code&rdquo;.</p>
<p>Terraform has the following advantages:</p>
<ul>
<li>
<p>Support multi-cloud deployment</p>
<p>Terraform is applicable to multi-cloud solutions. It deploys similar infrastructure to Alibaba Cloud, other cloud providers or local data centers. Developers can use the same tools and similar configuration files to manage the resources of different cloud providers at the same time.</p>
</li>
<li>
<p>Automated manage infrastructure</p>
<p>Terraform can create modules that can be reused to reduce deployment and management errors caused by human factors.</p>
</li>
<li>
<p>Infrastructure as Code</p>
<p>You can use code to manage maintenance resources. Allows you to save infrastructure state, enabling you to track changes to different components in your system (infrastructure as code) and share these configurations with others.</p>
</li>
<li>
<p>Reduce development costs</p>
<p>You reduce costs by creating development and deployment environments on demand. Also, you can evaluate before the system changes.</p>
</li>
</ul>
<h2 id="goal">Goal</h2>
<p>You can use Terraform to create a ShardingSphere high availability cluster on Amazon AWS. The cluster architecture is shown below. More cloud providers will be supported in the near future.</p>
<p><img src="../../../img/overview/terraform.png" alt=""></p>
<p>The Amazon resources created are the following:</p>
<ol>
<li>One ZooKeeper instance per AZ.</li>
<li>One Auto Scaling Group per AZ.</li>
<li>Each AZ has a Launch Template, which is used by the Auto Scaling Group to start the SharedingSphere Proxy instance.</li>
<li>An intranet Network LoadBalancer for applications.</li>
</ol>
<h2 id="quick-start">Quick Start</h2>
<h3 id="requirements">Requirements</h3>
<p>To create a ShardingSphere Proxy highly available cluster, you need to prepare the following resources in advance:</p>
<ol>
<li>An ssh keypair used to remotely connect EC2 instances.</li>
<li>One VPC.</li>
<li>The subnet of each AZ.</li>
<li>A SecurityGroup can release the 2888, 3888, and 2181 ports used by ZooKeeper Server.</li>
<li>An intranet HostedZone.</li>
<li>A common AMI image, such as Amazon linux2.</li>
</ol>
<p>Modify the parameters in <code>main.tf</code> according to the above prepared resources.</p>
<h3 id="procedure">Procedure</h3>
<ol>
<li>Enter the terraform directory, modify the parameters in <code>main.tf</code>  according to the above prepared resources.</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">git clone --depth<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> https://github.com/apache/shardingsphere-on-cloud.git
cd shardingsphere-on-cloud/terraform
</code></pre></div><p>The commands mentioned below need to be executed in the &lsquo;terraform&rsquo; directory.</p>
<ol start="2">
<li>Run the following command to initialize the terraform.</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">terraform init
</code></pre></div><p><img src="../../../img/operation-guide/5-1.png" alt=""></p>
<ol start="3">
<li>Run the following command to check the plan that terraform will execute, and check whether it meets your expectations.</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">terraform plan
</code></pre></div><p><img src="../../../img/operation-guide/5-2.png" alt=""></p>
<ol start="4">
<li>If the plan is as expected, you can execute the following command to create a cluster.</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">terraform apply
</code></pre></div><p><img src="../../../img/operation-guide/5-3.png" alt=""></p>
<p>After creation, the following outputs will be available:</p>
<p><img src="../../../img/operation-guide/5-4.png" alt=""></p>
<p>You need to record the value corresponding to <code>shardingsphere_domain</code>. Applications can access the proxy by connecting to the domain name.</p>
<ol start="5">
<li>If you want to delete the created cluster, you can run the following command:</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">terraform destroy
</code></pre></div><h2 id="user-manual">User Manual</h2>
<h3 id="dependency">Dependency</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>aws</td>
<td>4.37.0</td>
</tr>
</tbody>
</table>
<h3 id="module-list">Module List</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#ZK">zk</a></td>
<td>./zk</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#shardingsphere">shardingsphere</a></td>
<td>./shardingsphere</td>
</tr>
</tbody>
</table>
<h3 id="outputs">Outputs</h3>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#output_shardingsphere_domain">shardingsphere_domain</a></td>
<td>string</td>
<td>The final SharidngSphere proxy domain name provided internally, through which other applications can connect to the proxy</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#output_zk_node_domain">zk_node_domain</a></td>
<td>list(string)</td>
<td>List of domain names corresponding to ZooKeeper service</td>
</tr>
</tbody>
</table>
<h3 id="module-details">Module Details</h3>
<h4 id="zk">ZK</h4>
<p><strong>Internal resource list</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/instance">aws_instance.zk</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_interface">aws_network_interface.zk</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/route53_record">aws_route53_record.zk</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/ami">aws_ami.base</a></td>
<td>data source</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/availability_zones">aws_availability_zones.available</a></td>
<td>data source</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/route53_zone">aws_route53_zone.zone</a></td>
<td>data source</td>
</tr>
</tbody>
</table>
<p><strong>Inputs</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Default Value</th>
<th>Dependent on or not</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_cluster_size">cluster_size</a></td>
<td>Cluster size of the same number as the availability zone</td>
<td>number</td>
<td>n/a</td>
<td>yes</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_hosted_zone_name">hosted_zone_name</a></td>
<td>Private zone name</td>
<td>string</td>
<td>&ldquo;shardingsphere.org&rdquo;</td>
<td>no</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_instance_type">instance_type</a></td>
<td>EC2 instance type</td>
<td>string</td>
<td>n/a</td>
<td>yes</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_key_name">key_name</a></td>
<td>SSH key pair</td>
<td>string</td>
<td>n/a</td>
<td>yes</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_security_groups">security_groups</a></td>
<td>Security Group list. 2181, 2888, 3888 ports must be released</td>
<td>list(string)</td>
<td>[]</td>
<td>no</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_subnet_ids">subnet_ids</a></td>
<td>Subnet list sorted by AZ in VPC</td>
<td>list(string)</td>
<td>n/a</td>
<td>yes</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_tags">tags</a></td>
<td>ZooKeeper Server instance tags The default is: Name=zk-${count.idx}&rdquo;</td>
<td>map(any)</td>
<td>{}</td>
<td>no</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_vpc_id">vpc_id</a></td>
<td>VPC id</td>
<td>string</td>
<td>n/a</td>
<td>yes</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_zk_config">zk_config</a></td>
<td>Default configuration of ZooKeeper Server</td>
<td>map</td>
<td>{ <br>&quot;client_port&rdquo;: 2181, <br>&quot;zk_heap&rdquo;: 1024 <br>}&rdquo;</td>
<td>no</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_zk_version">zk_version</a></td>
<td>ZooKeeper Server version</td>
<td>string</td>
<td>&ldquo;3.7.1&rdquo;</td>
<td>no</td>
</tr>
</tbody>
</table>
<p><strong>Outputs</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#output_zk_node_domain">zk_node_domain</a></td>
<td>List of domain names corresponding to ZooKeeper Server</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#output_zk_node_private_ip">zk_node_private_ip</a></td>
<td>The intranet IP address of the ZooKeeper Server example</td>
</tr>
</tbody>
</table>
<h4 id="shardingsphere">ShardingSphere</h4>
<p><strong>Internal resource list</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/autoscaling_attachment">aws_autoscaling_attachment.asg_attachment_lb</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/autoscaling_group">aws_autoscaling_group.ss</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_template">aws_launch_template.ss</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb">aws_lb.ss</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_listener">aws_lb_listener.ss</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/lb_target_group">aws_lb_target_group.ss_tg</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/network_interface">aws_network_interface.ss</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/route53_record">aws_route53_record.ss</a></td>
<td>resource</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/availability_zones">aws_availability_zones.available</a></td>
<td>data source</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/route53_zone">aws_route53_zone.zone</a></td>
<td>data source</td>
</tr>
<tr>
<td><a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/vpc">aws_vpc.vpc</a></td>
<td>data source</td>
</tr>
</tbody>
</table>
<p><strong>Inputs</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Type</th>
<th>Default Value</th>
<th>Dependent on or not</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_cluster_size">cluster_size</a></td>
<td>Cluster size of the same number as the availability zone</td>
<td>number</td>
<td>n/a</td>
<td>yes</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_hosted_zone_name">hosted_zone_name</a></td>
<td>Private zone name</td>
<td>string</td>
<td>&ldquo;shardingsphere.org&rdquo;</td>
<td>no</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_image_id">image_id</a></td>
<td>AMI iamge ID</td>
<td>string</td>
<td>n/a</td>
<td>yes</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_instance_type">instance_type</a></td>
<td>EC2 instance type</td>
<td>string</td>
<td>n/a</td>
<td>yes</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_key_name">key_name</a></td>
<td>SSH key pair</td>
<td>string</td>
<td>n/a</td>
<td>yes</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_lb_listener_port">lb_listener_port</a></td>
<td>ShardingSphere Proxy startup port</td>
<td>string</td>
<td>n/a</td>
<td>yes</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_security_groups">security_groups</a></td>
<td>Security Group list</td>
<td>list(string)</td>
<td>[]</td>
<td>no</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_shardingsphere_version">shardingsphere_version</a></td>
<td>ShardingSphere Proxy version</td>
<td>string</td>
<td>n/a</td>
<td>yes</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_subnet_ids">subnet_ids</a></td>
<td>Subnet list sorted by AZ in VPC</td>
<td>list(string)</td>
<td>n/a</td>
<td>yes</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_vpc_id">vpc_id</a></td>
<td>VPC ID</td>
<td>string</td>
<td>n/a</td>
<td>yes</td>
</tr>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#input_zk_servers">zk_servers</a></td>
<td>Zookeeper Servers</td>
<td>list(string)</td>
<td>n/a</td>
<td>yes</td>
</tr>
</tbody>
</table>
<p><strong>Outputs</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/apache/shardingsphere-on-cloud/tree/main/terraform#output_shardingsphere_domain">shardingsphere_domain</a></td>
<td>The domain name provided by the shardingSphere Proxy cluster. Other applications can connect to the proxy through this domain name.</td>
</tr>
</tbody>
</table>
<h2 id="devops">DevOps</h2>
<p>By default, ZooKeeper and ShardingSphere Proxy services created using our Terraform configuration can be managed using systemd.</p>
<h3 id="zookeeper">ZooKeeper</h3>
<h4 id="start">Start</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">systemctl start zookeeper
</code></pre></div><h4 id="stop">Stop</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">systemctl stop zookeeper
</code></pre></div><h4 id="restart">Restart</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">systemctl restart zookeeper
</code></pre></div><h3 id="shardingsphere-proxy">ShardingSphere Proxy</h3>
<h4 id="start-1">Start</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">systemctl start shardingsphere
</code></pre></div><h4 id="stop-1">Stop</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">systemctl stop shardingsphere
</code></pre></div><h4 id="restart-1">Restart</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">systemctl restart shardingsphere
</code></pre></div>

<footer class=" footline" >
	
</footer>

        
            </div> 
        
        </div> 
        

      </div>

    <div id="navigation" >
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


        
            
                <a class="nav nav-prev" href="https://shardingsphere.apache.org/oncloud/0.1.1/en/operation-guide/cloudformation-multi-az/" title="CloudFormation Deploys ShardingSphere Proxy Cluster in Multiple AZs"> <i class="fa fa-long-arrow-left fa-lg"></i> Previous</a>
            
        
        
            
                <a class="nav nav-next" href="https://shardingsphere.apache.org/oncloud/0.1.1/en/best-practices/" title="Best Practices" style="margin-right: 0px;">Next<i class="fa fa-long-arrow-right fa-lg"></i></a>
            
        
    </div>

    </section>
</div>
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    
    <script src="https://shardingsphere.apache.org/oncloud/0.1.1/js/clipboard.min.js?1670319798"></script>
    <script src="https://shardingsphere.apache.org/oncloud/0.1.1/js/perfect-scrollbar.min.js?1670319798"></script>
    <script src="https://shardingsphere.apache.org/oncloud/0.1.1/js/perfect-scrollbar.jquery.min.js?1670319798"></script>
    <script src="https://shardingsphere.apache.org/oncloud/0.1.1/js/jquery.sticky.js?1670319798"></script>
    <script src="https://shardingsphere.apache.org/oncloud/0.1.1/js/featherlight.min.js?1670319798"></script>
    <script src="https://shardingsphere.apache.org/oncloud/0.1.1/js/html5shiv-printshiv.min.js?1670319798"></script>
    <script src="https://shardingsphere.apache.org/oncloud/0.1.1/js/highlight.pack.js?1670319798"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://shardingsphere.apache.org/oncloud/0.1.1/js/modernizr.custom.71422.js?1670319798"></script>
    <script src="https://shardingsphere.apache.org/oncloud/0.1.1/js/learn.js?1670319798"></script>
    <script src="https://shardingsphere.apache.org/oncloud/0.1.1/js/hugo-learn.js?1670319798"></script>
    <script>
        try{

            function log(fileName, category, locale){
                window._hmt.push(['_trackEvent', 'document', 'download', locale ? 'PDF_'+locale : fileName]);

                gtag('event', 'Downloads', {
                    'event_category' : locale ? 'PDF' : category,
                    'event_label' : locale ? locale+'.pdf' : fileName
                });
            }
            
            $('.padding[href*=shardingsphere]').on('click', function(){
                var locale = /cn/.test(location.pathname) ?'cn':'en';
                log('','', locale)
            })

            function getFileName(str){
                var strs = str.split('/');
                return strs[strs.length - 1]
            }

            $('a[href$="src.zip"]').on('click', function(){
                log(getFileName($(this).attr('href')), "SRC")
            })

            $('a[href$="zip.asc"]').on('click', function(){
                log(getFileName($(this).attr('href')), "ASC")
            })
            
            $('a[href$="zip.sha512"]').on('click', function(){
                log(getFileName($(this).attr('href')), "SHA512")
            })

            $('a[href$="tar.gz.asc"]').on('click', function(){
                log(getFileName($(this).attr('href')), "ASC")
            })
            
            $('a[href$="tar.gz.sha512"]').on('click', function(){
                log(getFileName($(this).attr('href')), "SHA512")
            })

            $('a[href$="tar.gz"]').on('click', function(){
                log(getFileName($(this).attr('href')), "TAR")
            })

        }catch(ex){}
    </script>
    

  </body>
</html>

